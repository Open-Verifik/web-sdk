<div class="flex flex-col flex-auto items-center sm:justify-center min-w-0" *ngIf="project">
    <div class="w-full sm:w-auto py-8 px-4 sm:p-12 sm:rounded-2xl sm:shadow sm:bg-card mx-auto main-card">
        <div class="w-full mx-auto sm:mx-0" style="max-width: 500px;">
            <!-- Logo -->
            <div class="w-full grid grid-cols-4">
                <div class="w-12">
                    <img [src]="project.branding.logo">
                </div>

                <div class="mt-3 text-2xl font-extrabold tracking-tight leading-tight col-span-3">{{project.name}}</div>
            </div>

            <!-- Title -->
            <div class="mt-8 text-4xl font-extrabold tracking-tight leading-tight">
                {{ 'start.title' | transloco}}
            </div>


            <div class="flex items-baseline mt-0.5 font-medium">
                <div>{{ 'start.existing_account_label' | transloco}}</div>
                <a class="ml-1 text-primary-500 hover:underline"
                    [routerLink]="['/passwordless/auth/', this.project._id]">
                    {{ 'start.login_here_link' | transloco}}
                </a>
            </div>

            <!-- Sign Up form -->
            <form class="mt-8" [formGroup]="signUpForm">

                <div class="grid grid-cols-2" *ngIf="groupFields.firstName">
                    <!-- Name field -->
                    <mat-form-field class="w-full">
                        <mat-label>{{ 'start.first_name' | transloco}}</mat-label>
                        <input id="firstName" matInput [formControlName]="'firstName'">
                        <mat-error *ngIf="signUpForm.get('firstName').hasError('required')" class="p-1">
                            {{ 'start.required_first_name' | transloco }}
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="ml-2 w-full">
                        <mat-label> {{ 'start.last_name' | transloco}}</mat-label>
                        <input id="lastName" matInput [formControlName]="'lastName'">
                        <mat-error *ngIf="signUpForm.get('lastName').hasError('required')" class="p-1">
                            {{ 'start.required_last_name' | transloco}}
                        </mat-error>
                    </mat-form-field>
                </div>

                <!-- Email field -->

                <!-- Email -->
                <div class="grid grid-cols-4" *ngIf="groupFields.email">
                    <mat-form-field class="w-full col-span-3">
                        <mat-label> {{ 'start.email' | transloco}}</mat-label>
                        <input id="email" matInput [formControlName]="'email'" type="email">
                        <mat-error *ngIf="signUpForm.get('email').hasError('required')" class="p-1">
                            {{ 'start.required_email' | transloco}}
                        </mat-error>
                        <mat-error *ngIf="signUpForm.get('email').hasError('email')" class="p-1">
                            {{ 'start.invalid_email' | transloco}}
                        </mat-error>
                    </mat-form-field>

                    <button mat-stroked-button class="mt-7 ml-2" color="primary"
                        (click)="sendOTP('email'); $event.preventDefault();" [disabled]="emailSent">
                        <span *ngIf="!emailSent">
                            {{'start.send_otp_button' | transloco }}
                        </span>

                        <mat-progress-spinner *ngIf="emailSent" [diameter]="12" [mode]="'indeterminate'">
                        </mat-progress-spinner>

                        <span *ngIf="emailSent">
                            ({{emailValidation.diff}}) s
                        </span>

                    </button>
                </div>
                <!-- Email OTP -->
                <mat-form-field class="w-full" *ngIf="groupFields.emailOTP">
                    <mat-label> {{ 'start.email_otp' | transloco}}</mat-label>
                    <input id="emailOTP" matInput type="password" [formControlName]="'emailOTP'" #passwordField>
                    <button mat-icon-button type="button"
                        (click)="passwordField.type === 'password' ? passwordField.type = 'number' : passwordField.type = 'password'"
                        matSuffix>
                        <mat-icon class="icon-size-5" *ngIf="passwordField.type === 'password'"
                            [svgIcon]="'heroicons_solid:eye'"></mat-icon>
                        <mat-icon class="icon-size-5" *ngIf="passwordField.type === 'text'"
                            [svgIcon]="'heroicons_solid:eye-off'"></mat-icon>
                    </button>
                    <mat-error class="p-1">
                        {{ 'start.code_is_required' | transloco}}
                    </mat-error>
                </mat-form-field>

                <!-- phone field -->
                <div class="grid grid-cols-4" *ngIf="groupFields.phone">
                    <mat-form-field class="w-full">
                        <mat-label> {{ 'start.country_code' | transloco}}</mat-label>
                        <mat-select *ngIf="countries" class="mr-1.5" [formControl]="signUpForm.get('countryCode')"
                            matPrefix>
                            <mat-select-trigger>
                                <span class="flex items-center">
                                    <span
                                        class="sm:mx-0.5 font-medium text-default">{{ signUpForm.get('countryCode').value }}</span>
                                </span>
                            </mat-select-trigger>
                            <ng-container *ngFor="let country of countries; trackBy: trackByFn">
                                <mat-option [value]="country.code">
                                    <span class="flex items-center">
                                        <span class="ml-2">{{country.name}}</span>
                                        <span class="ml-2 font-medium">{{country.code}}</span>
                                    </span>
                                </mat-option>
                            </ng-container>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field class="w-full col-span-2 ml-1 mr-1" *ngIf="groupFields.phone">
                        <mat-label> {{ 'start.phone' | transloco}}</mat-label>
                        <input id="phone" matInput [formControlName]="'phone'" type="number">
                        <mat-error *ngIf="signUpForm.get('phone').hasError('required')" class="p-1">
                            {{ 'start.required_phone' | transloco}}
                        </mat-error>
                        <mat-error *ngIf="signUpForm.get('phone').hasError('phone')" class="p-1">
                            {{ 'start.invalid_phone' | transloco}}
                        </mat-error>
                    </mat-form-field>


                    <button mat-stroked-button class="mt-7 ml-2" color="primary"
                        (click)="sendOTP('phone'); $event.preventDefault();" [disabled]="smsSent">
                        <span *ngIf="!smsSent">
                            {{ 'start.send_otp_button' | transloco}}
                        </span>

                        <mat-progress-spinner *ngIf="smsSent" [diameter]="12" [mode]="'indeterminate'">
                        </mat-progress-spinner>

                        <span *ngIf="smsSent">
                            ({{phoneValidation.diff}}) s
                        </span>

                    </button>
                </div>

                <!-- phoneOTP -->
                <mat-form-field class="w-full" *ngIf="groupFields.phoneOTP">
                    <mat-label>{{ 'start.phone_otp' | transloco}} </mat-label>
                    <input id="phoneOTP" matInput type="password" [formControlName]="'phoneOTP'" #passwordField>
                    <button mat-icon-button type="button"
                        (click)="passwordField.type === 'password' ? passwordField.type = 'text' : passwordField.type = 'password'"
                        matSuffix>
                        <mat-icon class="icon-size-5" *ngIf="passwordField.type === 'password'"
                            [svgIcon]="'heroicons_solid:eye'"></mat-icon>
                        <mat-icon class="icon-size-5" *ngIf="passwordField.type === 'text'"
                            [svgIcon]="'heroicons_solid:eye-off'"></mat-icon>
                    </button>
                    <mat-error class="p-1">
                        {{ 'start.code_is_required' | transloco}}
                    </mat-error>
                </mat-form-field>

                <!-- ToS and PP -->
                <div class="inline-flex items-end w-full mt-1.5">
                    <mat-checkbox [color]="'primary'" [formControlName]="'agreements'">
                        <span>{{ 'start.terms_1' | transloco}}</span>
                        <a class="ml-1 text-primary-500 hover:underline"
                            (click)="openConditions('tos')">{{ 'start.terms_2' | transloco}}
                        </a>
                        <span>{{ 'start.terms_3' | transloco}}</span>
                        <a class="ml-1 text-primary-500 hover:underline"
                            (click)="openConditions('pt')">{{ 'start.terms_4' | transloco}}
                        </a>
                    </mat-checkbox>
                </div>

                <!-- Submit button -->
                <button class="fuse-mat-button-large w-full mt-6" mat-flat-button [color]="'primary'"
                    [disabled]="!isFormValid()" (click)="signUp()">
                    <span *ngIf="!signUpForm.disabled">
                        {{ 'start.create_account_button' | transloco }}
                    </span>
                    <mat-progress-spinner *ngIf="signUpForm.disabled" [diameter]="24" [mode]="'indeterminate'">
                    </mat-progress-spinner>
                </button>

            </form>

            <fuse-alert class="mt-8" *ngIf="showAlert" [appearance]="'outline'" [showIcon]="false" [type]="alert.type"
                [@shake]="alert.type === 'error'">
                {{'errors.' + alert.message | transloco}}
            </fuse-alert>

            <div class="w-full text-center mt-6">
                <languages></languages>
            </div>

        </div>
    </div>
</div>