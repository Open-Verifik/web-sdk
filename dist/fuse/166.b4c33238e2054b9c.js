"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[166],{3166:(Q,F,l)=>{l.r(F),l.d(F,{default:()=>it});var g=l(6814),L=l(1447),R=l(6223),m=l(2296),K=l(1043),U=l(4516),S=l(5940),O=l(4748),y=l(6420),s=l(8533),C=l(5789),v=l(5986),f=l(8991),e=l(5879),T=l(8340),u=l(3814);function J(o,r){1&o&&e._UZ(0,"img",21)}function W(o,r){1&o&&e._UZ(0,"img",22)}function X(o,r){1&o&&e._UZ(0,"img",23)}function q(o,r){1&o&&e._UZ(0,"img",24)}function z(o,r){1&o&&(e.TgZ(0,"h3",25),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"step_one.cards.liveness")))}function G(o,r){1&o&&(e.TgZ(0,"h3",25),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"step_one.cards.compare")))}function B(o,r){1&o&&(e.TgZ(0,"h3",26),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"step_one.cards.verify_id")))}function $(o,r){1&o&&(e.TgZ(0,"h3",27),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"step_one.cards.id")))}function ee(o,r){if(1&o&&(e.TgZ(0,"div",10)(1,"div",11)(2,"div",12),e.YNc(3,J,1,0,"img",13),e.YNc(4,W,1,0,"img",14),e.YNc(5,X,1,0,"img",15),e.YNc(6,q,1,0,"img",16),e.qZA(),e.YNc(7,z,3,3,"h3",17),e.YNc(8,G,3,3,"h3",17),e.YNc(9,B,3,3,"h3",18),e.YNc(10,$,3,3,"h3",19),e.qZA(),e.TgZ(11,"p",20),e._uU(12),e.qZA()()),2&o){const t=r.$implicit,i=r.index;e.xp6(3),e.Q6J("ngIf","documentReview"===t.code),e.xp6(1),e.Q6J("ngIf","document"===t.code),e.xp6(1),e.Q6J("ngIf","liveness"===t.code),e.xp6(1),e.Q6J("ngIf","end"===t.code),e.xp6(1),e.Q6J("ngIf","liveness"===t.code),e.xp6(1),e.Q6J("ngIf","end"===t.code),e.xp6(1),e.Q6J("ngIf","documentReview"===t.code),e.xp6(1),e.Q6J("ngIf","document"===t.code),e.xp6(2),e.Oqu(i+1)}}function te(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"h1"),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"p",3),e._uU(6),e.ALo(7,"transloco"),e.qZA(),e.TgZ(8,"p",4),e._uU(9),e.ALo(10,"transloco"),e.qZA()(),e.TgZ(11,"div",5)(12,"div",6),e.YNc(13,ee,13,9,"div",7),e.qZA(),e.TgZ(14,"div",8)(15,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.startKYC())}),e._uU(16),e.ALo(17,"transloco"),e.qZA()()(),e._UZ(18,"div"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,5,"signup.instructions_step.title")),e.xp6(3),e.hij(" ",e.lcZ(7,7,"signup.instructions_step.header")," "),e.xp6(3),e.Oqu(e.lcZ(10,9,"signup.instructions_step.subtitle")),e.xp6(4),e.Q6J("ngForOf",t.navigation.displayableSteps),e.xp6(3),e.hij(" ",e.lcZ(17,11,"signup.instructions_step.button")," ")}}let ie=(()=>{class o{constructor(t){this._KYCService=t,this.appRegistration=this._KYCService.appRegistration,this.project=this._KYCService.currentProject,this.projectFlow=this._KYCService.currentProjectFlow,this.navigation=this._KYCService.getNavigation(),this.steps=[]}ngOnInit(){this.defineStepsAndInstrutions()}defineStepsAndInstrutions(){this.appRegistration.documentValidation&&this.navigation.map.document&&this._KYCService.navigateTo("document"),this.appRegistration.biometricValidation&&this.navigation.map.liveness&&this._KYCService.navigateTo("liveness")}ngOnDestroy(){}startKYC(){this._KYCService.navigateTo(this.navigation.displayableSteps[0].code)}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(T.H))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["kyc-instructions"]],standalone:!0,features:[e.jDz],decls:1,vars:1,consts:[["class","step-one-main-div","fxLayout","column","fxLayoutAlign","start center",4,"ngIf"],["fxLayout","column","fxLayoutAlign","start center",1,"step-one-main-div"],["fxLayout","column","fxLayoutAlign","center center",1,"step-one-middle-container"],[1,"p-1"],[1,"p-2"],["fxLayout","column","fxLayoutAlign","center center",1,"step-one-woman-and-options"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","center center","fxLayoutWrap","true",1,"steps-in-cards"],["fxLayout","column","fxLayoutAlign","start center",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","start center",1,"accept-terms-container"],["mat-raised-button","","color","primary",1,"mt-8","z-index-2","start-demo-button",3,"click"],["fxLayout","column","fxLayoutAlign","start center"],["fxLayout","column","fxLayoutAlign","start center",1,"step-one-card"],["fxLayout","row","fxLayoutAlign","center center",1,"step-one-card-image"],["src","https://cdn.verifik.co/demo/x2Step2.png","alt","","class","id_in_card_img",4,"ngIf"],["src","https://cdn.verifik.co/demo/id_in_card.png","alt","","class","id_in_card_img",4,"ngIf"],["src","https://cdn.verifik.co/demo/x2Step3.png","alt","","class","id_in_card_img",4,"ngIf"],["src","https://cdn.verifik.co/demo/x2Step4.png","alt","","class","id_in_card_img",4,"ngIf"],["class","mt-4 text-center m-2",4,"ngIf"],["class","mt-4 text-center",4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"step-one-circle"],["src","https://cdn.verifik.co/demo/x2Step2.png","alt","",1,"id_in_card_img"],["src","https://cdn.verifik.co/demo/id_in_card.png","alt","",1,"id_in_card_img"],["src","https://cdn.verifik.co/demo/x2Step3.png","alt","",1,"id_in_card_img"],["src","https://cdn.verifik.co/demo/x2Step4.png","alt","",1,"id_in_card_img"],[1,"mt-4","text-center","m-2"],[1,"mt-4","text-center"],[1,"mt-4"]],template:function(i,n){1&i&&e.YNc(0,te,19,13,"div",0),2&i&&e.Q6J("ngIf",n.appRegistration&&n.project&&n.projectFlow)},dependencies:[L.o9,u.xw,u.Wh,f.y4,f.Ot,g.ez,g.sg,g.O5,v.p9,m.ot,m.lW],styles:[".step-one-main-div{width:100%;padding-top:100px}.step-one-logo{width:82px;height:auto}.error-text{color:#ed4c5c!important}.step-one-middle-container{width:50%}.step-one-woman-and-options,.w-full{width:100%}.p-1{font-size:16px;text-align:center;color:#01236db1}.p-2{font-size:16px;font-weight:800;text-align:center;color:#01236db1}.business-woman-image{width:500px;position:absolute;bottom:60px;height:auto;z-index:1}.step-one-card{margin-top:30px;z-index:2;width:240px;min-height:310px;margin-right:25px;background:white;border:1px solid rgba(204,204,204,.3960784314);box-shadow:3px 3px 3px 3px #0000000d}.step-one-card h3{text-align:center}.step-one-card-image{height:185px}.id_in_card_img{padding:10px}h3{font-size:16px;font-weight:600}.step-one-circle{background:#0036e7;z-index:2;position:relative;bottom:20px;color:#fff;width:45px;height:45px;padding-top:11px;text-align:center;border-radius:50%;margin-right:25px}.text-center{text-align:center}.z-index-2{z-index:2}.accept-terms-container{height:250px}.form-div{padding-bottom:100px}.form-div form{width:40%!important;margin-top:50px;z-index:2}.error-w{width:40%!important}@media (max-width: 599px){.step-one-main-div{padding-top:20px}.form-div h1{padding:12px;text-align:center}.form-div form{width:90%!important;margin-top:50px;z-index:2}.error-w{width:90%!important}.step-one-logo{width:62px}.step-one-middle-container{width:90%}.step-one-middle-container h1{text-align:center}.business-woman-image{width:350px;position:absolute;bottom:60px;height:auto;z-index:1;opacity:.3}.step-one-card{margin-top:32px}.accept-terms-container{height:300px;width:90%}.start-demo-button{width:280px!important}.steps-in-cards{width:100%;overflow-x:scroll}}a{text-decoration:underline;font-weight:800}@media (min-width: 600px) and (max-width: 959px){.step-one-main-div{padding-top:40px}.form-div h1{padding:20px;text-align:center}.form-div form{width:85%!important;margin-top:50px;z-index:2}.error-w{width:85%!important}.step-one-logo{width:62px}.step-one-middle-container{width:90%}.step-one-middle-container h1{text-align:center}.start-demo-button{width:240px!important}.step-one-card{width:180px}.step-one-card h3{font-size:14px}}@media (min-width: 960px) and (max-width: 1279px){.step-one-main-div{padding-top:40px}.form-div form{width:60%!important;margin-top:50px;z-index:2}.error-w{width:60%!important}.step-one-logo{width:68px}.step-one-middle-container{width:65%}.step-one-middle-container h1{text-align:center}.start-demo-button{width:280px!important}.step-one-card{width:200px}}@media (min-width: 1280px) and (max-width: 1919px){.step-one-main-div{padding-top:30px}.step-one-middle-container{width:70%}.step-one-middle-container h1{text-align:center}.business-woman-image{width:450px;position:absolute;bottom:60px;height:auto;z-index:1;opacity:.5}}\n"],encapsulation:2,data:{animation:O.L}})}return o})();var _=l(5861),A=l(7700),j=l(6007),P=l(9036),Z=l(553),Y=l(8645),x=l(6799),D=l(9162),k=l(6036);const ne=["video"],oe=["canvas"],se=["result"],ae=["toSend"],re=["credentialCanvas"];function ce(o,r){1&o&&e._UZ(0,"canvas",3,4)}function le(o,r){if(1&o&&(e.TgZ(0,"div",19)(1,"div",20),e._uU(2),e.qZA(),e.TgZ(3,"div",21),e._uU(4),e.qZA()()),2&o){const t=e.oxw(3);e.xp6(2),e.Oqu(t.errorFace.title),e.xp6(2),e.Oqu(t.errorFace.subtitle)}}function de(o,r){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9),e.YNc(2,le,5,2,"div",10),e.qZA(),e.TgZ(3,"div",11),e._UZ(4,"video",12,13)(6,"div",14,15)(8,"canvas",16,17)(10,"canvas",16,18),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.errorFace&&!t.loadingResults),e.xp6(1),e.Udp("width",t.WIDTH,"px")("height",t.HEIGHT,"px"),e.xp6(1),e.Udp("max-width",t.maxWidth,"px")("max-height",t.maxHeight,"px"),e.ekj("hidden",t.base64Image),e.xp6(2),e.Udp("width",t.WIDTH,"px")("height",t.HEIGHT,"px"),e.ekj("hidden",t.base64Image),e.xp6(2),e.ekj("hidden",!t.base64Image),e.xp6(2),e.ekj("hidden",!0)}}function he(o,r){1&o&&(e.TgZ(0,"div",22),e._UZ(1,"img",23),e.TgZ(2,"h1",24),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"p",24),e._uU(6),e.ALo(7,"transloco"),e.qZA()()),2&o&&(e.xp6(3),e.Oqu(e.lcZ(4,2,"id_scanning.camera_not_found")),e.xp6(3),e.hij(" ",e.lcZ(7,4,"id_scanning.camera_not_found_description")," "))}function pe(o,r){if(1&o&&(e.TgZ(0,"div",5),e.YNc(1,de,12,21,"div",6),e.YNc(2,he,8,6,"div",7),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.loadingModel&&!t.lowCamera),e.xp6(1),e.Q6J("ngIf",!t.loadingModel&&t.lowCamera)}}function me(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",8)(1,"button",29),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.recordLiveness(!0))}),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"transloco"),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Udp("color",t.project.branding.txtColor),e.xp6(1),e.hij(" ",e.lcZ(4,3,"errors.replace_person_button")," ")}}function ge(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",8)(1,"button",29),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.continueRedirection())}),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"transloco"),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Udp("color",t.project.branding.txtColor),e.xp6(1),e.hij(" ",e.lcZ(4,3,"errors.continue_without_biometrics")," ")}}function ue(o,r){if(1&o&&(e.TgZ(0,"div",25)(1,"div",26),e._UZ(2,"img",27),e.TgZ(3,"h1",28),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.YNc(6,me,5,5,"div",6),e.YNc(7,ge,5,5,"div",6),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,3,"errors."+t.errorContent.message)," "),e.xp6(2),e.Q6J("ngIf","person_already_set"===t.errorContent.message),e.xp6(1),e.Q6J("ngIf","collection_not_set."===t.errorContent.message)}}let fe=(()=>{class o{constructor(t,i,n,a,c,d){this._changeDetectorRef=t,this._demoService=i,this._translocoService=n,this._splashScreenService=a,this.renderer=c,this._KYCService=d,this._matDialog=(0,e.f3M)(A.uw),this.debugText="debug",this.OVAL={},this.loadingResults=!1,this.loadingModel=!1,this._unsubscribeAll=new Y.x,this.minPixelFace=234,this.videoOptions={frameRate:{ideal:30,max:30}},this.setMaxDimensions=()=>{this.maxHeight=Math.floor(.7*window.innerHeight),this.maxWidth=Math.floor(.9*window.innerWidth)},this.setCanvasDimension=()=>{this.HEIGHT=Math.min(this.videoInput.clientHeight,this.maxHeight),this.WIDTH=Math.min(this.videoInput.clientWidth,this.maxWidth),this.videoCenterX=this.WIDTH/2,this.videoCenterY=this.HEIGHT/2,this.marginY=.04*this.HEIGHT,this.marginX=.8*this.marginY,this.OVAL.radiusY=.42*this.HEIGHT,this.OVAL.radiusX=.75*this.OVAL.radiusY,2*this.OVAL.radiusX>=this.WIDTH&&(this.OVAL.radiusX=.48*this.WIDTH,this.OVAL.radiusY=this.OVAL.radiusX/.75),this.displaySize={width:this.WIDTH,height:this.HEIGHT},this.resizeDimensions={rectHeight:this.HEIGHT,rectWidth:Math.min(2.8*this.OVAL.radiusX,this.WIDTH),y:0,x:this.videoCenterX-Math.min(2.8*this.OVAL.radiusX,this.WIDTH)/2},this.originalDimensions={rectHeight:this.videoDimensions.height,rectWidth:this.resizeDimensions.rectWidth/this.WIDTH*this.videoDimensions.width,y:0,x:this.resizeDimensions.x/this.WIDTH*this.videoDimensions.width}},this.continueWithLiveness=this._initAppRegistrationData(),this.continueWithLiveness&&(this.loadingModel=!0,this.lowCamera=!1,this.debugIndex=0,this.successPosition=0,this.showError=!1,this.errorContent={message:""},this.videoOptions[this.demoData.isMobile?"width":"height"]={ideal:1080},this.listenModeDebug(),this.appLoginToken=localStorage.getItem("accessToken"))}_initAppRegistrationData(){return this.osInfo=this.detectOS(),this.demoData=this._demoService.getDemoData(),this.appRegistration=this._KYCService.appRegistration,this.appRegistration.biometricValidation&&this.appRegistration.person?(this._KYCService.navigateTo("next"),!1):(this.project=this._KYCService.currentProject,this.projectFlow=this._KYCService.currentProjectFlow,this.navigation=this._KYCService.getNavigation(),!0)}ngOnInit(){var t=this;return(0,_.Z)(function*(){t.continueWithLiveness&&(t._splashScreenService.show(),t.errorFace=null,t.loadingResults=!1,t.base64Image=null,yield t.loadImages(),t.setMaxDimensions(),t.renderer.listen("window","resize",()=>{t.setMaxDimensions(),t.videoInput&&(t.setCanvasDimension(),t.setConfigCanvas())}),t._demoService.faceapi$.subscribe(i=>{t.loadingModel=!i,i&&t.startAsyncVideo()}))})()}listenModeDebug(){this.isActiveDebug=!!localStorage.getItem("isActiveDebug"),document.addEventListener("keydown",t=>{if(this.debugText.charAt(this.debugIndex)===t.key.toLowerCase())return 3===this.debugIndex&&(this.isActiveDebug=!this.isActiveDebug,localStorage.setItem("isActiveDebug",this.isActiveDebug?"true":""),this._changeDetectorRef.markForCheck()),this.debugIndex++;this.debugIndex=0})}stopRecord(){this.detectFaceInterval&&clearInterval(this.detectFaceInterval),this.stream&&this.stream.getTracks().forEach(t=>t.stop())}restart(){var t=this;return(0,_.Z)(function*(){t.completeResults(),yield t.startAsyncVideo()})()}loadImages(){var t=this;return(0,_.Z)(function*(){t.left=new Image,t.left.crossOrigin="anonymous",t.left.src="https://cdn.verifik.co/web-sdk/images/left.png",t.right=new Image,t.right.crossOrigin="anonymous",t.right.src="https://cdn.verifik.co/web-sdk/images/right.png",t.up=new Image,t.up.crossOrigin="anonymous",t.up.src="https://cdn.verifik.co/web-sdk/images/up.png",t.down=new Image,t.down.crossOrigin="anonymous",t.down.src="https://cdn.verifik.co/web-sdk/images/down.png"})()}startAsyncVideo(){var t=this;return(0,_.Z)(function*(){try{t.stream=yield navigator.mediaDevices.getUserMedia({video:t.videoOptions,audio:!1}),t.videoInput=t.video.nativeElement,t.videoInput.srcObject=t.stream,t.videoInput.style.transform="scaleX(-1)",t.canvasRef.nativeElement.style.transform="scaleX(-1)";const n=t.stream.getVideoTracks()[0].getSettings(),{width:a,height:c}=n;if(t.videoDimensions={height:c,width:a},c<600)return t.lowCamera=!0,t.loadingModel=!1,void t._splashScreenService.hide();t.videoInput.addEventListener("loadeddata",()=>{t.video||t.canvas?(t.setCanvasDimension(),t._splashScreenService.hide(),t.detectFaces()):t.stopRecord()})}catch(i){alert(`${i.message}`),console.error("SHOW ERROR",i)}})()}detectFaces(){var t=this;return(0,_.Z)(function*(){yield t.setConfigCanvas(),t.detectFaceInterval=setInterval((0,_.Z)(function*(){try{const i=yield x.Qr(t.videoInput,new x.d7({minConfidence:.2})).withFaceLandmarks(),n=t.canvas.getContext("2d");i.length>0&&(t.lastFace=i[0],t.errorFace=null,t.drawFaceAndCenter(i,n),t.isFaceCentered(t.lastFace.landmarks.getNose()[3]),t.isFaceClose(t.lastFace.landmarks),t.drawStatusOval(n,!t.errorFace?.title),t.errorFace?t.successPosition=0:++t.successPosition,t.errorFace||(t.successPosition=0,t.captureBase64Image())),t._changeDetectorRef.markForCheck()}catch(i){alert(i.message)}}),t.demoData.isMobile?500:300)})()}setConfigCanvas(){var t=this;return(0,_.Z)(function*(){t.canvas||(t.canvas=yield x.Jd(t.videoInput),t.canvasEl=t.canvasRef.nativeElement,t.canvasEl.appendChild(t.canvas),t.canvas.setAttribute("id","canvas")),x.JF(t.canvas,t.displaySize);const i=t.canvas.getContext("2d");t.drawOvalCenterAndMask(i)})()}drawFaceAndCenter(t,i){const n=x._C(t,this.displaySize);this.drawOvalCenterAndMask(i),this.isActiveDebug&&(i.strokeStyle="red",i.lineWidth=4,i.strokeRect(this.videoCenterX-this.marginX,this.videoCenterY,2*this.marginX,2*this.marginY),x.ii.drawFaceLandmarks(this.canvas,n),x.ii.drawFaceExpressions(this.canvas,n),new x.ii.DrawBox(t[0].detection.box,{label:`${t[0].gender.toUpperCase()} | ${Math.round(t[0].age)} years old`}).draw(this.canvas))}drawOvalCenterAndMask(t){t.clearRect(0,0,this.canvas.width,this.canvas.height),t.fillStyle="rgba(255, 255, 255, 0.75)",t.fillRect(0,0,this.canvas.width,this.canvas.height),t.globalCompositeOperation="destination-out",t.fillStyle="rgba(255, 255, 255, 1)",t.beginPath(),t.ellipse(this.videoCenterX,this.videoCenterY,this.OVAL.radiusX,this.OVAL.radiusY,0,0,2*Math.PI),t.fill(),t.closePath(),t.globalCompositeOperation="source-over"}drawText(t,i,n,a){t.font="30px Arial",t.textAlign="center";const c=t.measureText(i);t.fillStyle="black",t.fillRect(n-c.width/2,a-30-10,c.width+2,60),t.fillStyle="white",t.fillText(i,n,a)}drawStatusOval(t,i){t.beginPath(),t.ellipse(this.videoCenterX,this.videoCenterY,this.OVAL.radiusX,this.OVAL.radiusY,0,0,2*Math.PI),t.lineWidth=5,t.strokeStyle=i?"green":"red",t.stroke(),t.closePath(),i||(this.errorFace.canvas?.includes("\u2191")&&t.drawImage(this.up,this.videoCenterX-20,this.videoCenterY-this.OVAL.radiusY+10,40,40),this.errorFace.canvas?.includes("\u2193")&&t.drawImage(this.down,this.videoCenterX-20,this.videoCenterY+this.OVAL.radiusY-50,40,40),this.errorFace.canvas?.includes("\u2192")&&t.drawImage(this.right,this.videoCenterX+this.OVAL.radiusX-50,this.videoCenterY-20,40,40),this.errorFace.canvas?.includes("\u2190")&&t.drawImage(this.left,this.videoCenterX-this.OVAL.radiusX+10,this.videoCenterY-20,40,40)),this._changeDetectorRef.markForCheck()}isFaceCentered(t){const i=t.x/this.videoDimensions.width*this.WIDTH,n=t.y/this.videoDimensions.height*this.HEIGHT;if(!(i>this.videoCenterX-this.marginX&&i<this.videoCenterX+this.marginX&&n>this.videoCenterY&&n<this.videoCenterY+2.5*this.marginY)){let c="";(i<this.videoCenterX-this.marginX||i>this.videoCenterX+this.marginX)&&(c+=` ${i<this.videoCenterX-this.marginX?"\u2192":"\u2190"} `),(n<this.videoCenterY||n>this.videoCenterY+2*this.marginY)&&(c+=` ${n<this.videoCenterY?"\u2191":"\u2193"}  `),this.errorFace={title:this._translocoService.translate("liveness.center_yor_face"),subtitle:this._translocoService.translate("liveness.center_your_face_subtitle"),canvas:c}}}isFaceClose(t){(t.imageHeight*t.imageWidth/Math.floor(this.originalDimensions.rectHeight*this.originalDimensions.rectWidth)<.25||t.imageHeight<this.minPixelFace||t.imageWidth<this.minPixelFace)&&(this.errorFace={title:this._translocoService.translate("liveness.get_closer"),subtitle:this._translocoService.translate("liveness.get_closer_subtitle")})}captureBase64Image(){this.saveImageBase64Intent||(this.saveImageBase64Intent=setTimeout(()=>{this.errorFace&&(this.saveImageBase64Intent=clearTimeout(this.saveImageBase64Intent)),this.takePicture()},1500))}takePicture(){var t=this;return(0,_.Z)(function*(){const i=t.canvasToSendRef.nativeElement;t.setPictureInCavas(t.canvasResultRef.nativeElement,t.resizeDimensions,t.originalDimensions),t.setPictureInCavas(i,t.originalDimensions),t.base64Image=i.toDataURL("image/jpeg").replace(/^data:.*;base64,/,""),t.stopRecord(),t.recordLiveness()})()}setPictureInCavas(t,i,n){const a=t.getContext("2d");t.width=i.rectWidth,t.height=i.rectHeight,t.style.marginLeft=`${i.x}px`,t.style.marginTop=`${i.y}px`,n||(n={x:i.x,y:i.y,rectWidth:i.rectWidth,rectHeight:i.rectHeight}),a.drawImage(this.video.nativeElement,n.x,n.y,n.rectWidth,n.rectHeight,0,0,i.rectWidth,i.rectHeight)}detectOS(){const t=window.navigator.userAgent.toLowerCase();return/android/.test(t)?"ANDROID":/iphone|ipad|ipod/.test(t)?"IOS":"DESKTOP"}recordLiveness(t){this.loadingResults||(this.loadingResults=!0,this._splashScreenService.show(),this._KYCService.createBiometricValidation({image:this.base64Image,os:this.osInfo,force:!!t}).subscribe({next:n=>{this.appRegistration.person=n.data.person,this.appRegistration.biometricValidation=n.data.biometricValidation},error:n=>{this.showError=!0,this.errorContent=n.error,this._splashScreenService.hide(),this.loadingResults=!1},complete:()=>{this._splashScreenService.hide(),this.loadingResults=!1,this._KYCService.navigateTo("next")}}))}retryLivenessModal(t){const i={title:this._translocoService.translate("liveness.liveness_failed"),message:this._translocoService.translate("liveness.liveness_error_message",{error:t}),icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:this._translocoService.translate("confirm"),color:"primary"},cancel:{show:!0,label:this._translocoService.translate("cancel")}},dismissible:!1};this._matDialog.open(P.u,{autoFocus:!1,disableClose:!0,panelClass:"fuse-confirmation-dialog-panel",data:i}).afterClosed().subscribe(n=>{if("confirmed"===n)return this.restart()})}completeResults(){this.errorFace=null,this.loadingResults=!1,this.base64Image=null,this.errorResult||this.stopRecord(),this.saveImageBase64Intent&&(this.saveImageBase64Intent=clearTimeout(this.saveImageBase64Intent)),this._splashScreenService.hide(),this._changeDetectorRef.markForCheck()}ngOnDestroy(){this._unsubscribeAll.next(null),this.loadingResults=!1,this.video=void 0,this.detectFaceInterval&&this.stopRecord()}continueRedirection(){if(this.showError&&"person_not_found"===this.errorContent.message)return void window.location.reload();const t=localStorage.getItem("accessToken");window.location.href=`${Z.N.verifikProject===this.project._id?`${Z.N.appUrl}/sign-in`:this.projectFlow.redirectUrl}?type=login&token=${t}`}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.sBO),e.Y36(D.e),e.Y36(f.Vn),e.Y36(k.j),e.Y36(e.Qsj),e.Y36(T.H))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["kyc-liveness"]],viewQuery:function(i,n){if(1&i&&(e.Gf(ne,5),e.Gf(oe,5),e.Gf(se,5),e.Gf(ae,5),e.Gf(re,5)),2&i){let a;e.iGM(a=e.CRH())&&(n.video=a.first),e.iGM(a=e.CRH())&&(n.canvasRef=a.first),e.iGM(a=e.CRH())&&(n.canvasResultRef=a.first),e.iGM(a=e.CRH())&&(n.canvasToSendRef=a.first),e.iGM(a=e.CRH())&&(n.credentialRef=a.first)}},standalone:!0,features:[e.jDz],decls:3,vars:3,consts:[["hidden","true",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","min-h-[60vh] justify-center p-4 sm:p-1 xs:p-1 w-full",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","flex w-full",4,"ngIf"],["hidden","true"],["credentialCanvas",""],["fxLayout","column","fxLayoutAlign","center center",1,"min-h-[60vh]","justify-center","p-4","sm:p-1","xs:p-1","w-full"],["fxLayout","column","fxLayoutAlign","center center","class","w-full",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","id-scanning-error-div",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center",1,"w-full"],["fxLayout","column","fxLayoutAlign","center center",1,"text-center","h-20","sm:h-8","xs:h-8","my-2"],["class","mb-4",4,"ngIf"],[1,"relative"],["autoplay","",1,"absolute","top-0","left-0","oval-video"],["video",""],[1,"absolute","top-0","left-0","oval-video"],["canvas",""],[1,"absolute"],["result",""],["toSend",""],[1,"mb-4"],[1,"text-3xl","font-bold"],[1,"text-gray-600"],["fxLayout","column","fxLayoutAlign","center center",1,"id-scanning-error-div"],["src","https://cdn.verifik.co/demo/nocameraenabled.svg","alt","",1,"id-scanning-no-camera-enabled-img"],[1,"mt-4"],["fxLayout","column","fxLayoutAlign","center center",1,"flex","w-full"],["fxLayout","column","fxLayoutAlign","center center",1,"rounded-2xl","end-card","w-1/2","shadow","overflow-hidden","bg-card","error-dialog","p-8","mt-11"],["src","https://cdn.verifik.co/access/warning.svg","alt","",1,"w-50"],[1,"text-center"],["mat-stroked-button","",1,"w-11/12","mt-4",3,"click"]],template:function(i,n){1&i&&(e.YNc(0,ce,2,0,"canvas",0),e.YNc(1,pe,3,2,"div",1),e.YNc(2,ue,8,5,"div",2)),2&i&&(e.Q6J("ngIf",!n.showError&&n.project),e.xp6(1),e.Q6J("ngIf",!n.showError&&n.project),e.xp6(1),e.Q6J("ngIf",n.showError))},dependencies:[L.o9,u.xw,u.Wh,g.ez,g.O5,A.Is,f.y4,f.Ot,m.ot,m.lW,j.Cv,S.Cq],styles:[".thumbnail[_ngcontent-%COMP%]{width:250px}.end-card[_ngcontent-%COMP%]{max-width:400px!important}@media (max-width: 599px){.end-card[_ngcontent-%COMP%]{width:90%!important}}@media (min-width: 600px) and (max-width: 959px){.end-card[_ngcontent-%COMP%]{width:80%!important}}"]})}return o})();function ve(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e._UZ(2,"img",3),e.TgZ(3,"h3",4),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e._UZ(6,"img",5),e.TgZ(7,"h3",6),e._uU(8),e.qZA(),e.TgZ(9,"div",7)(10,"button",8),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.completeAndRedirect())}),e.TgZ(11,"span"),e._uU(12),e.ALo(13,"transloco"),e.qZA()()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,6,"signup.end_step.title")),e.xp6(2),e.Q6J("src","data:image/jpeg;base64,"+t.appRegistration.person.thumbnails[0].thumbnail,e.LSH),e.xp6(2),e.hij(" ",t.appRegistration.person.name," "),e.xp6(3),e.Udp("color",t.project.branding.txtColor),e.xp6(1),e.Oqu(e.lcZ(13,8,"signup.end_step.complete_button"))}}let _e=(()=>{class o{constructor(t,i){this._KYCService=t,this._splashScreenService=i,this.showError=!1,this.errorContent={message:""},this._initAppRegistrationData()}ngOnInit(){}_initAppRegistrationData(){this.appRegistration=this._KYCService.appRegistration,this.project=this._KYCService.currentProject,this.projectFlow=this._KYCService.currentProjectFlow,this.navigation=this._KYCService.getNavigation()}ngOnDestroy(){}completeAndRedirect(){if(this.loading)return;this.loading=!0,this._splashScreenService.show();let t={token:null};this._KYCService.syncAppRegistration("liveness").subscribe({next:i=>{t=i.data},error:i=>{console.error({exception:i}),this._splashScreenService.hide()},complete:()=>{this._splashScreenService.hide(),this.loading=!1,window.location.href=`${Z.N.verifikProject===this.project._id?`${Z.N.appUrl}/sign-in`:this.projectFlow.redirectUrl}?type=onboarding&token=${t.token}`}})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(T.H),e.Y36(k.j))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["kyc-end"]],standalone:!0,features:[e.jDz],decls:1,vars:1,consts:[["fxLayout","column","fxLayoutAlign","center center","class","flex w-full",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center",1,"flex","w-full"],["fxLayout","column","fxLayoutAlign","center center",1,"rounded-2xl","end-card","w-1/2","shadow","overflow-hidden","bg-card","error-dialog","p-8","mt-11"],["src","https://cdn.verifik.co/access/check.svg","alt","",1,"w-20"],[1,"text-center","text-2xl","pt-4","pb-8"],["alt","",1,"thumbnail",3,"src"],[1,"text-center","pt-4"],["fxLayout","column","fxLayoutAlign","center center",1,"w-full"],["mat-stroked-button","",1,"w-11/12","mt-4",3,"click"]],template:function(i,n){1&i&&e.YNc(0,ve,14,10,"div",0),2&i&&e.Q6J("ngIf",!n.showError&&n.appRegistration&&!n.appRegistration.documentValidation&&n.appRegistration.person)},dependencies:[L.o9,u.xw,u.Wh,g.ez,g.O5,A.Is,f.y4,f.Ot,m.ot,m.lW,j.Cv,S.Cq],styles:[".thumbnail[_ngcontent-%COMP%]{width:250px}.end-card[_ngcontent-%COMP%]{max-width:400px!important}@media (max-width: 599px){.end-card[_ngcontent-%COMP%]{width:90%!important}}@media (min-width: 600px) and (max-width: 959px){.end-card[_ngcontent-%COMP%]{width:80%!important}}"]})}return o})();var H=l(2982),xe=l(4354);const we=["maskResult"],ye=["toSend"];function Ce(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",7)(1,"button",8),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.recordLiveness(!0))}),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"transloco"),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Udp("color",t.project.branding.txtColor),e.xp6(1),e.hij(" ",e.lcZ(4,3,"errors.replace_person_button")," ")}}function be(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",7)(1,"button",8),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.continueRedirection())}),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"transloco"),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Udp("color",t.project.branding.txtColor),e.xp6(1),e.hij(" ",e.lcZ(4,3,"errors.continue_without_biometrics")," ")}}function Ie(o,r){if(1&o&&(e.TgZ(0,"div",2)(1,"div",3),e._UZ(2,"img",4),e.TgZ(3,"h1",5),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.YNc(6,Ce,5,5,"div",6),e.YNc(7,be,5,5,"div",6),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,3,"errors."+t.errorContent.message)," "),e.xp6(2),e.Q6J("ngIf","person_already_set"===t.errorContent.message),e.xp6(1),e.Q6J("ngIf","collection_not_set."===t.errorContent.message)}}function Le(o,r){if(1&o&&(e.TgZ(0,"div")(1,"div",21),e._uU(2),e.qZA(),e.TgZ(3,"div",22),e._uU(4),e.qZA()()),2&o){const t=e.oxw(3);e.xp6(2),e.Oqu(t.errorFace.title),e.xp6(2),e.Oqu(t.errorFace.subtitle)}}function Ae(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"webcam",23),e.NdJ("imageCapture",function(n){e.CHM(t);const a=e.oxw(3);return e.KtG(a.proccessImage(n))})("initError",function(n){e.CHM(t);const a=e.oxw(3);return e.KtG(a.cameraError(n))}),e.qZA()}if(2&o){const t=e.oxw(3);e.Q6J("height",t.camera.dimensions.video.max.height)("width",t.camera.dimensions.video.max.width)("videoOptions",t.camera.configuration)("imageQuality",1)("captureImageData",!0)("allowCameraSwitch",!1)("trigger",t.takePicture$)("mirrorImage",t.demoData.isMobile?"never":"always")}}function Se(o,r){if(1&o&&(e.TgZ(0,"div",12)(1,"div",13),e.YNc(2,Le,5,2,"div",14),e.qZA(),e.TgZ(3,"div",15),e.YNc(4,Ae,1,8,"webcam",16),e._UZ(5,"canvas",17,18)(7,"canvas",19,20),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.errorFace&&!t.response.isLoading),e.xp6(1),e.Udp("width",t.camera.dimensions.video.width,"px")("height",t.camera.dimensions.video.height,"px"),e.xp6(1),e.Q6J("ngIf",!t.response.base64Image),e.xp6(1),e.Udp("width",t.response.base64Image?t.camera.dimensions.result.width:t.camera.dimensions.video.width,"px")("height",t.response.base64Image?t.camera.dimensions.result.height:t.camera.dimensions.video.height,"px")}}function Te(o,r){1&o&&(e.TgZ(0,"div",24),e._UZ(1,"img",25),e.TgZ(2,"h1",26),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"p",26),e._uU(6),e.ALo(7,"transloco"),e.qZA()()),2&o&&(e.xp6(3),e.Oqu(e.lcZ(4,2,"id_scanning.camera_not_found")),e.xp6(3),e.hij(" ",e.lcZ(7,4,"id_scanning.camera_not_found_description")," "))}function Ze(o,r){if(1&o&&(e.TgZ(0,"div",9),e.YNc(1,Se,9,10,"div",10),e.YNc(2,Te,8,6,"div",11),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.camera.isLoading&&t.camera.hasPermissions&&!t.camera.isLowQuality),e.xp6(1),e.Q6J("ngIf",!t.camera.isLoading&&t.camera.isLowQuality)}}let De=(()=>{class o{constructor(t,i,n,a,c,d,b){this._dom=t,this._changeDetectorRef=i,this._demoService=n,this._translocoService=a,this._splashScreenService=c,this.renderer=d,this._KYCService=b,this._matDialog=(0,e.f3M)(A.uw),this.aspectRatio=.75,this._unsubscribeAll=new Y.x,this.takePicture=new Y.x,this.setDefaultFace=()=>{this.face={successPosition:0,minPixels:240,minHeight:600,threshold:.25}},this.setDefaultDirections=()=>{this.direction={left:new Image,right:new Image,up:new Image,down:new Image},this.direction.right.crossOrigin="anonymous",this.direction.up.crossOrigin="anonymous",this.direction.down.crossOrigin="anonymous",this.direction.left.crossOrigin="anonymous",this.direction.left.src="https://cdn.verifik.co/web-sdk/images/left.png",this.direction.right.src="https://cdn.verifik.co/web-sdk/images/right.png",this.direction.up.src="https://cdn.verifik.co/web-sdk/images/up.png",this.direction.down.src="https://cdn.verifik.co/web-sdk/images/down.png"},this.setDefaultAttempts=()=>{this.attempts={current:0,limit:3}},this.setDefaultCamera=()=>{this.camera={hasPermissions:!1,isLoading:!1,isLowQuality:!1,configuration:{frameRate:{ideal:30,max:30},[this.demoData.isMobile?"width":"height"]:{ideal:1080},facingMode:xe.w.USER},dimensions:{video:{max:{height:Math.ceil(.7*window.innerHeight),width:Math.ceil(.9*window.innerWidth)}}}}},this.setDefaultResponse=()=>{this.response={isLoading:!1,isFailed:!1}},this.setDefaultInterval=()=>{this.interval={}},this.setVideoNgxCameraData=()=>{const h=this._dom.nativeElement.querySelector("video");h&&(h.addEventListener("loadeddata",()=>{this.setVideoDimensions(h),this.drawOvalCenterAndMask(),this.interval.detectFace||(this.interval.detectFace=setInterval(()=>{this.response.base64Image&&(this.interval.detectFace=clearInterval(this.interval.detectFace)),this.takePicture.next()},this.demoData.time))}),this.interval.checkNgxVideo=clearInterval(this.interval.checkNgxVideo),this.setVideoDimensions(h),this.drawOvalCenterAndMask(),this.loading({isLoading:!1,start:!0}))},this.getCenterAndRadius=(h,w)=>{const p={center:{x:w/2,y:h/2},radius:{x:0,y:0},margin:{y:.05*h,x:0}};return p.margin.x=.8*p.margin.y,p.radius.y=.42*h,p.radius.x=p.radius.y*this.aspectRatio,2*p.radius.x>=w&&(p.radius.x=.48*w,p.radius.y=p.radius.x/this.aspectRatio),p},this.loading=({isLoading:h=!0,start:w,result:p})=>{const I=w?"camera":p&&"response";I&&(this[I].isLoading=h),this._splashScreenService[h?"show":"hide"]()},this.setImageOnCanvas=(h,w,p,I)=>{h.width=I.width,h.height=I.height,h.style.marginLeft=`${I.offsetX||0}px`,h.style.marginTop=`${I.offsetY||0}px`;const M=h.getContext("2d");M.clearRect(0,0,p.width,p.height),M.drawImage(w,p.offsetX,p.offsetY,p.width,p.height,0,0,I.width,I.height)},this.continueWithLiveness=this._initAppRegistrationData(),this.continueWithLiveness&&(this.demoData=this._demoService.getDemoData(),this.startDefaultValues(),this.setDefaultAttempts(),this.setDefaultDirections(),this.setDefaultFace(),this.setDefaultInterval(),this.renderer.listen("window","resize",()=>{this.interval.checkNgxVideo=setInterval(()=>{this.setMaxVideoDimensions(),this.setVideoNgxCameraData()},this.demoData.time)}),this.showError=!1,this.errorContent={message:""},this.projectFlow=this.project.currentProjectFlow,this._changeDetectorRef.markForCheck())}ngOnInit(){var t=this;this.continueWithLiveness&&(this.startDefaultValues(),this.camera.hasPermissions=!0,this.loading({start:!0}),this._demoService.faceapi$.subscribe(function(){var i=(0,_.Z)(function*(n){t.camera.isLoading=!n,t.setMaxVideoDimensions(),n&&(t.interval.checkNgxVideo=setInterval(()=>{t.setVideoNgxCameraData()},100))});return function(n){return i.apply(this,arguments)}}()))}_initAppRegistrationData(){return this.demoData=this._demoService.getDemoData(),this.appRegistration=this._KYCService.appRegistration,this.appRegistration.biometricValidation&&this.appRegistration.person?(this._KYCService.navigateTo("next"),!1):(this.project=this._KYCService.currentProject,this.projectFlow=this._KYCService.currentProjectFlow,this.navigation=this._KYCService.getNavigation(),!0)}get takePicture$(){return this.takePicture.asObservable()}startDefaultValues(){this.setDefaultResponse(),this.setDefaultCamera(),this.setMaxVideoDimensions()}setVideoDimensions(t){this.camera.dimensions.video.height=t.clientHeight,this.camera.dimensions.video.width=t.clientWidth,this.camera.dimensions.result={height:0,width:0,offsetX:0,offsetY:0},this.setResultDimensions("result",t.clientHeight,t.clientWidth),this.face.video=this.getCenterAndRadius(t.clientHeight,t.clientWidth);const i=this.maskResultCanvasRef.nativeElement;i.style.marginLeft="0px",i.style.marginTop="0px"}setMaxVideoDimensions(){this.camera.dimensions.video={max:{height:Math.ceil(.7*window.innerHeight),width:Math.ceil(.9*window.innerWidth)}},this.camera.dimensions.result=void 0}drawOvalCenterAndMask(){const t=this.camera.dimensions.video,i=this.maskResultCanvasRef.nativeElement;i.height=t.height,i.width=t.width;const n=i.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="rgba(255, 255, 255, 0.75)",n.fillRect(0,0,t.width,t.height),n.globalCompositeOperation="destination-out";const{center:a,radius:c}=this.face.video;n.fillStyle="rgba(255, 255, 255, 1)",n.beginPath(),n.ellipse(a.x,a.y,c.x,c.y,0,0,2*Math.PI),n.fill(),n.closePath(),n.globalCompositeOperation="source-over"}setResultDimensions(t,i,n){const{center:a,radius:c}=this.face[t]=this.getCenterAndRadius(i,n);this.camera.dimensions[t].height=i,this.camera.dimensions[t].offsetY=0,this.camera.dimensions[t].width=Math.min(2.8*c.x,n),this.camera.dimensions[t].offsetX=a.x-this.camera.dimensions[t].width/2}cameraError(t){t.mediaStreamError&&"NotAllowedError"===t.mediaStreamError.name&&(this.loading({isLoading:!1,start:!0}),this.camera.hasPermissions=!1)}proccessImage(t){var i=this;if(!this.interval.detectFace||this.response.base64Image)return;const n=new Image;n.src=t.imageAsDataUrl,n.onload=(0,_.Z)(function*(){if(n.height<i.face.minHeight)i.camera.isLowQuality=!0;else try{i.camera.dimensions.real={height:0,width:0,offsetX:0,offsetY:0},i.setResultDimensions("real",n.height,n.width),i.face.real=i.getCenterAndRadius(n.height,n.width);const a=yield x.Qr(n,new x.d7({minConfidence:.2})).withFaceLandmarks(),c=i.maskResultCanvasRef.nativeElement.getContext("2d");if(a.length>0&&(i.lastFace=a[0],i.errorFace=null,i.drawOvalCenterAndMask(),i.isFaceCentered(i.lastFace.landmarks.getNose()[3]),i.isFaceClose(i.lastFace.landmarks),i.drawStatusOval(c,!i.errorFace?.title),i.errorFace?i.face.successPosition=0:++i.face.successPosition,!i.errorFace&&i.face.successPosition>2))return i.face.successPosition=0,void i.takePictureLiveness(n);i._changeDetectorRef.markForCheck()}catch(a){alert(a.message)}})}takePictureLiveness(t){this.setImageOnCanvas(this.maskResultCanvasRef.nativeElement,t,this.camera.dimensions.real,this.camera.dimensions.result);const n=this.ToSendCanvasRef.nativeElement;this.setImageOnCanvas(n,t,this.camera.dimensions.real,this.camera.dimensions.real),this.response.base64Image=n.toDataURL("image/jpeg"),this.recordLiveness()}drawStatusOval(t,i){const{center:n,radius:a}=this.face.video;t.beginPath(),t.ellipse(n.x,n.y,a.x,a.y,0,0,2*Math.PI),t.lineWidth=5,t.strokeStyle=i?"green":"red",t.stroke(),t.closePath(),i||(this.errorFace.canvas?.includes("\u2191")&&t.drawImage(this.direction.up,n.x-20,n.y-a.y+10,40,40),this.errorFace.canvas?.includes("\u2193")&&t.drawImage(this.direction.down,n.x-20,n.y+a.y-50,40,40),this.errorFace.canvas?.includes("\u2192")&&t.drawImage(this.direction.right,n.x+a.x-50,n.y-20,40,40),this.errorFace.canvas?.includes("\u2190")&&t.drawImage(this.direction.left,n.x-a.x+10,n.y-20,40,40)),this._changeDetectorRef.markForCheck()}inRange(t,i,n){return t>=i&&t<=n}isFaceCentered(t){const i=t.x,n=t.y,{center:a,margin:c}=this.face.real,d=this.inRange(i,a.x-c.x,a.x+c.x),b=this.inRange(n,a.y,a.y+2.5*c.y);if(!d||!b){let w="";d||(w+=i<a.x-c.x?"\u2192":"\u2190"),b||(w+=n<a.y?"\u2193":"\u2191"),this.errorFace={title:this._translocoService.translate("liveness.center_yor_face"),subtitle:this._translocoService.translate("liveness.center_your_face_subtitle"),canvas:w}}}isFaceClose(t){const i=this.camera.dimensions.real;(t.imageHeight*t.imageWidth/Math.floor(i.height*(i.width-i.offsetX))<this.face.threshold||t.imageHeight<this.face.minPixels||t.imageWidth<this.face.minPixels)&&(this.errorFace={title:this._translocoService.translate("liveness.get_closer"),subtitle:this._translocoService.translate("liveness.get_closer_subtitle")})}recordLiveness(t){if(this.response.isLoading)return;this.loading({result:!0});const i={image:this.response.base64Image.replace(/^data:.*;base64,/,""),os:this.demoData.OS,force:!!t};this._KYCService.createBiometricValidation(i).subscribe({next:n=>{this.appRegistration.person=n.data.person,this.appRegistration.biometricValidation=n.data.biometricValidation,console.log(this.appRegistration)},error:n=>{this.showError=!0,this.errorContent=n.error,this._splashScreenService.hide(),this.loading({isLoading:!1,result:!0})},complete:()=>{this._splashScreenService.hide(),this.loading({isLoading:!1,result:!0}),this._KYCService.navigateTo("next")}})}retryLivenessModal(t){const i={title:this._translocoService.translate("liveness.liveness_failed"),message:this._translocoService.translate("liveness.liveness_error_message",{error:t}),icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:this._translocoService.translate("confirm"),color:"primary"},cancel:{show:!0,label:this._translocoService.translate("cancel")}},dismissible:!1};this._matDialog.open(P.u,{autoFocus:!1,disableClose:!0,panelClass:"fuse-confirmation-dialog-panel",data:i}).afterClosed().subscribe(n=>{if("confirmed"===n)return this.setDefaultInterval(),this.setDefaultFace(),this.ngOnInit();this._demoService.restart()})}continueRedirection(){if(this.showError&&"person_not_found"===this.errorContent.message)return void window.location.reload();const t=localStorage.getItem("accessToken");window.location.href=`${Z.N.verifikProject===this.project._id?`${Z.N.appUrl}/sign-in`:this.projectFlow.redirectUrl}?type=login&token=${t}`}ngOnDestroy(){this._unsubscribeAll.next(null)}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(e.SBq),e.Y36(e.sBO),e.Y36(D.e),e.Y36(f.Vn),e.Y36(k.j),e.Y36(e.Qsj),e.Y36(T.H))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["kyc-liveness-ios"]],viewQuery:function(i,n){if(1&i&&(e.Gf(we,5),e.Gf(ye,5)),2&i){let a;e.iGM(a=e.CRH())&&(n.maskResultCanvasRef=a.first),e.iGM(a=e.CRH())&&(n.ToSendCanvasRef=a.first)}},standalone:!0,features:[e.jDz],decls:2,vars:2,consts:[["fxLayout","column","fxLayoutAlign","center center","class","flex w-full",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","min-h-[60vh] justify-center p-4 sm:p-1 xs:p-1 w-full",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center",1,"flex","w-full"],["fxLayout","column","fxLayoutAlign","center center",1,"rounded-2xl","end-card","w-1/2","shadow","overflow-hidden","bg-card","error-dialog","p-8","mt-11"],["src","https://cdn.verifik.co/access/warning.svg","alt","",1,"w-50"],[1,"text-center"],["fxLayout","column","fxLayoutAlign","center center","class","w-full",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center",1,"w-full"],["mat-stroked-button","",1,"w-11/12","mt-4",3,"click"],["fxLayout","column","fxLayoutAlign","center center",1,"min-h-[60vh]","justify-center","p-4","sm:p-1","xs:p-1","w-full"],["fxLayout","column","fxLayoutAlign","center center","class","justify-center w-full",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","id-scanning-error-div",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center",1,"justify-center","w-full"],["fxLayout","column","fxLayoutAlign","center center",1,"justify-center","text-center","h-20","sm:h-8","xs:h-8","my-2"],[4,"ngIf"],[1,"relative"],[3,"height","width","videoOptions","imageQuality","captureImageData","allowCameraSwitch","trigger","mirrorImage","imageCapture","initError",4,"ngIf"],[1,"absolute","top-0","left-0"],["maskResult",""],["hidden","true"],["toSend",""],[1,"text-3xl","font-bold"],[1,"text-gray-600"],[3,"height","width","videoOptions","imageQuality","captureImageData","allowCameraSwitch","trigger","mirrorImage","imageCapture","initError"],["fxLayout","column","fxLayoutAlign","center center",1,"id-scanning-error-div"],["src","https://cdn.verifik.co/demo/nocameraenabled.svg","alt","",1,"id-scanning-no-camera-enabled-img"],[1,"mt-4"]],template:function(i,n){1&i&&(e.YNc(0,Ie,8,5,"div",0),e.YNc(1,Ze,3,2,"div",1)),2&i&&(e.Q6J("ngIf",n.showError&&n.project),e.xp6(1),e.Q6J("ngIf",!n.showError&&n.project))},dependencies:[L.o9,u.xw,u.Wh,g.ez,g.O5,A.Is,f.y4,f.Ot,m.ot,m.lW,j.Cv,S.Cq,H.Tm,H.i3],styles:[".thumbnail[_ngcontent-%COMP%]{width:250px}.end-card[_ngcontent-%COMP%]{max-width:400px!important}@media (max-width: 599px){.end-card[_ngcontent-%COMP%]{width:90%!important}}@media (min-width: 600px) and (max-width: 959px){.end-card[_ngcontent-%COMP%]{width:80%!important}}"]})}return o})();var ke=l(1094),Fe=l(692),Re=l(9773),N=l(617),Oe=l(9236),V=l(7509);const Ye=["cardIdFace"];function Me(o,r){if(1&o&&e._UZ(0,"img",18),2&o){const t=e.oxw(2);e.Q6J("src",t.base64Image,e.LSH)}}function Ke(o,r){1&o&&e._UZ(0,"mat-icon",19)}const je=function(o){return{"text-xs":o}};function Ue(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",6),e.NdJ("fileDropped",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onFileDropped(n))}),e.TgZ(1,"input",7,8),e.NdJ("change",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.fileBrowseHandler(n.target.files))}),e.qZA(),e.TgZ(3,"div",9)(4,"div",10)(5,"div",11),e.YNc(6,Me,1,1,"img",12),e.YNc(7,Ke,1,0,"mat-icon",13),e.qZA()(),e.TgZ(8,"div",14)(9,"div",15),e._uU(10),e.ALo(11,"transloco"),e.qZA(),e.TgZ(12,"div",16),e._uU(13),e.ALo(14,"transloco"),e.qZA()()(),e.TgZ(15,"label",17),e._uU(16),e.ALo(17,"transloco"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngIf",t.base64Image),e.xp6(1),e.Q6J("ngIf",!t.base64Image),e.xp6(3),e.hij(" ",e.lcZ(11,6,"step_two.drag_n_drop_title")," "),e.xp6(3),e.hij(" ",e.lcZ(14,8,"step_two.drag_n_drop_description")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(12,je,t.phoneMode)),e.xp6(1),e.Oqu(e.lcZ(17,10,"step_two.upload_button"))}}function Pe(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",20)(1,"button",21),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.cancelUpload())}),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.TgZ(4,"button",22),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.continue())}),e._uU(5),e.ALo(6,"transloco"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,3,"step_two.cancel_button")," "),e.xp6(2),e.Q6J("disabled",!t.base64Image),e.xp6(1),e.hij(" ",e.lcZ(6,5,"step_two.continue_button")," ")}}function He(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",23),e._UZ(1,"img",24),e.TgZ(2,"h1",25),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"p",25),e._uU(6),e.ALo(7,"transloco"),e.qZA(),e.TgZ(8,"button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.tryAgain(!0))}),e._uU(9),e.ALo(10,"transloco"),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("src","https://cdn.verifik.co/demo/failedtodetectdocument@3x.png",e.LSH),e.xp6(2),e.hij(" ",e.lcZ(4,4,"id_scanning.document_not_detected")," "),e.xp6(3),e.hij(" ",e.lcZ(7,6,"id_scanning.document_not_detected_description")," "),e.xp6(3),e.hij(" ",e.lcZ(10,8,"id_scanning.retry")," "))}let Ne=(()=>{class o{constructor(t,i,n,a,c){this._demoService=t,this.dialogRef=i,this._splashScreenService=n,this.mediaService=a,this._KYCService=c,this._unsubscribeAll=new Y.x,this.demoData=this._demoService.getDemoData(),this.attempts=0,this.attemptsLimit=1,this.errorContent={message:""},this.mediaService.onMediaChange$.pipe((0,Re.R)(this._unsubscribeAll)).subscribe(d=>{this.phoneMode=!d.matchingAliases.includes("lg")&&!d.matchingAliases.includes("md")&&!d.matchingAliases.includes("sm")})}ngOnDestroy(){this._unsubscribeAll.complete()}onFileDropped(t){this.prepareFilesList(t)}fileBrowseHandler(t){this.prepareFilesList(t)}prepareFilesList(t){var i=this;const n=new FileReader;this._splashScreenService.show(),n.onload=a=>{const c=new Image;c.src=a.target.result,c.onload=(0,_.Z)(function*(){try{const d=yield i.detectFace(c);if(i.demoData.loading=!1,i._splashScreenService.hide(),!d)return i.errorResult=!0,void(i.errorContent={message:"id_scanning.face_not_found"});i.base64Image=a.target.result;const b=i._demoService.getBiggestFace(d);console.log({faces:d,faceBiggest:b}),i.faceIdCard=i._demoService.cutFaceIdCard(c,b,i.cardIdFaceRef.nativeElement)}catch(d){alert(d.message)}})},n.readAsDataURL(t[0])}detectFace(t){return(0,_.Z)(function*(){try{const i=yield x.Qr(t,new x.d7({minConfidence:.2})).withFaceLandmarks();return i.length?i.map(n=>n.detection.box):void 0}catch(i){alert(i.message)}})()}cancelUpload(){this.dialogRef.close()}tryAgain(){this.errorResult=!1,this.base64Image=null,this.attempts++}restartDemo(){this._demoService.moveToStep(1),this.dialogRef.close()}continue(){if(this.demoData.loading)return;this.demoData.loading=!0,this._splashScreenService.show();const t={image:this.base64Image.replace(/^data:image\/.*;base64,/,"")};this._KYCService.createDocumentValidation(t).subscribe({next:i=>{console.log({response:i.data})},error:i=>{this.errorContent=i.error,this.errorResult=!0,console.log({exception:i,errorContent:this.errorContent})},complete:()=>{this.demoData.loading=!1}})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(D.e),e.Y36(A.so),e.Y36(k.j),e.Y36(Oe.T),e.Y36(T.H))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["kyc-document-uploader"]],viewQuery:function(i,n){if(1&i&&e.Gf(Ye,5),2&i){let a;e.iGM(a=e.CRH())&&(n.cardIdFaceRef=a.first)}},standalone:!0,features:[e.jDz],decls:6,vars:3,consts:[["fxLayout","column","fxLayoutAlign","center center",1,"w-full"],["hidden","true"],["cardIdFace",""],["class","white-background csv-container w-full sm:w-3/5 mt-10","appDnd","",3,"fileDropped",4,"ngIf"],["class","w-full mt-5","fxLayout","row","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","id-scanning-error-div",4,"ngIf"],["appDnd","",1,"white-background","csv-container","w-full","sm:w-3/5","mt-10",3,"fileDropped"],["type","file","id","fileDropRef","accept","image/*",3,"change"],["fileDropRef",""],[1,"grid","grid-cols-4"],[1,"flex","items-center","col-span-4","sm:col-span-1","justify-center"],[1,"flex","items-center","rounded-lg","justify-center","p-4","text-primary-700","dark:bg-primary","dark:text-on-primary",2,"min-width","7rem !important","max-width","7rem !important"],["alt","Imagen seleccionada",3,"src",4,"ngIf"],["svgIcon","feather:upload","style","transform: scale(2); filter: invert(14%) sepia(100%) saturate(4147%) hue-rotate(228deg) brightness(89%) contrast(114%)",4,"ngIf"],[1,"flex","flex-col","col-span-4","sm:col-span-3","text-start"],[1,"text-sm","mt-4"],[1,"text-xs","text-secondary","mb-6"],["for","fileDropRef",1,"mx-2",3,"ngClass"],["alt","Imagen seleccionada",3,"src"],["svgIcon","feather:upload",2,"transform","scale(2)","filter","invert(14%) sepia(100%) saturate(4147%) hue-rotate(228deg) brightness(89%) contrast(114%)"],["fxLayout","row","fxLayoutAlign","center center",1,"w-full","mt-5"],["mat-stroked-button","","color","warn",1,"mx-2",3,"click"],["mat-raised-button","","color","primary",1,"mx-2",3,"disabled","click"],["fxLayout","column","fxLayoutAlign","center center",1,"id-scanning-error-div"],["alt","",1,"id-scanning-failed-document-img",3,"src"],[1,"mt-4"],["mat-raised-button","","color","primary",1,"mt-4","z-index-2","id-scanning-try-again-button",3,"click"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"canvas",1,2),e.YNc(3,Ue,18,14,"div",3),e.YNc(4,Pe,7,7,"div",4),e.YNc(5,He,11,10,"div",5),e.qZA()),2&i&&(e.xp6(3),e.Q6J("ngIf",!n.errorResult),e.xp6(1),e.Q6J("ngIf",!n.errorResult),e.xp6(1),e.Q6J("ngIf",n.errorResult&&n.attemptsLimit))},dependencies:[g.ez,g.mk,g.O5,L.o9,u.xw,u.Wh,V.oO,f.y4,f.Ot,N.Ps,N.Hw,m.ot,m.lW],styles:[".id-scanning-error-div[_ngcontent-%COMP%]{width:auto;background:white;height:600px;padding:16px}.id-scanning-error-div[_ngcontent-%COMP%]   .id-scanning-failed-document-img[_ngcontent-%COMP%]{width:30%}.id-scanning-error-div[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#0036e7;font-size:24px;font-weight:800;text-align:center}.id-scanning-error-div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#01236da6;font-size:16px;font-weight:300;text-align:center}.menu-section[_ngcontent-%COMP%]{width:50%;min-height:300px;padding-bottom:100px;padding-left:32px;padding-right:16px}.white-background[_ngcontent-%COMP%]{width:50%;background-color:#fff;padding-bottom:100px;padding-left:32px;padding-right:16px}.csv-container[_ngcontent-%COMP%]{height:auto;padding:2rem;text-align:center;border:dashed 3px #979797;border-radius:.5rem;position:relative;margin:0 auto}.csv-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;position:absolute;z-index:2;width:100%;height:100%;top:0;left:0}.csv-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#fff;width:auto;height:auto;border-radius:21.5px;background-color:#0036e7;padding:8px}.csv-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#38424c}.btn-cancel[_ngcontent-%COMP%]{color:#fff;width:auto;height:auto;border-radius:21.5px;background-color:#0036e7;padding:8px;z-index:10}"]})}return o})();function Ve(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"h2",6),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e._UZ(5,"img",7),e.TgZ(6,"button",8),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openUploadFile())}),e._uU(7),e.ALo(8,"transloco"),e.qZA()(),e.TgZ(9,"div",9)(10,"h2",6),e._uU(11),e.ALo(12,"transloco"),e.qZA(),e._UZ(13,"img",10),e.TgZ(14,"button",8),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openCamera())}),e._uU(15),e.ALo(16,"transloco"),e.qZA()()()}2&o&&(e.xp6(3),e.hij(" ",e.lcZ(4,4,"step_two.file_description")," "),e.xp6(4),e.hij(" ",e.lcZ(8,6,"step_two.file")," "),e.xp6(4),e.hij(" ",e.lcZ(12,8,"step_two.manual_description")," "),e.xp6(4),e.hij(" ",e.lcZ(16,10,"step_two.manual")," "))}function Ee(o,r){1&o&&e._UZ(0,"div",11)}function Qe(o,r){1&o&&e._UZ(0,"id-scanning-ios",12)}function Je(o,r){1&o&&e._UZ(0,"id-scanning",12)}let We=(()=>{class o{constructor(t,i){this._demoService=t,this.dialog=i,this.demoData=this._demoService.getDemoData(),this.selectOption=""}ngOnInit(){this._demoService.getAddress()}openUploadFile(){this.dialog.open(Ne,{width:"900px"}).afterClosed().subscribe(i=>{console.log({result:i})})}openCamera(){this.selectOption="idscan"}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(D.e),e.Y36(A.uw))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["kyc-document"]],standalone:!0,features:[e.jDz],decls:5,vars:4,consts:[["fxLayout","column","fxLayoutAlign","center center",1,"w-full"],["class","id-details-body w-full","fxLayout","row","fxLayout.xs","column","fxLayoutAlign","start start","fxLayoutAlign.xs","center center",4,"ngIf"],["class","white-background","fxHide.xs","true",4,"ngIf"],["fxLayoutAlign","center center","class","w-full h-full mb-6",4,"ngIf"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","start start","fxLayoutAlign.xs","center center",1,"id-details-body","w-full"],["fxLayout","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start center",1,"w-50p","upload-file-section"],[1,"title-margin"],["src","https://cdn.verifik.co/demo/anverso2x.png","alt","",1,"upload-img"],["mat-raised-button","","color","primary",1,"mb-5",3,"click"],["fxLayout","column","fxLayoutAlign","start center","fxLayoutAlign.xs","start center",1,"w-50p","scan-file-section"],["src","https://cdn.verifik.co/demo/scan2x.png","alt","",1,"scan-img"],["fxHide.xs","true",1,"white-background"],["fxLayoutAlign","center center",1,"w-full","h-full","mb-6"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0),e.YNc(1,Ve,17,12,"div",1),e.YNc(2,Ee,1,0,"div",2),e.YNc(3,Qe,1,0,"id-scanning-ios",3),e.YNc(4,Je,1,0,"id-scanning",3),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngIf",!n.selectOption),e.xp6(1),e.Q6J("ngIf",!n.selectOption),e.xp6(1),e.Q6J("ngIf","idscan"===n.selectOption&&"IOS"==n.demoData.OS),e.xp6(1),e.Q6J("ngIf","idscan"===n.selectOption&&"IOS"!=n.demoData.OS))},dependencies:[L.o9,u.xw,u.Wh,V.b8,v.p9,m.ot,m.lW,ke.s,Fe.s,g.ez,g.O5,f.y4,f.Ot],styles:[".white-background[_ngcontent-%COMP%]{width:50%;background-color:#fff;position:absolute;z-index:-1;top:0;left:50%;height:100%}.scan-img[_ngcontent-%COMP%]{width:400px;padding:2rem}.upload-img[_ngcontent-%COMP%]{width:450px;padding:2rem}.title-margin[_ngcontent-%COMP%]{margin-top:1.25rem;margin-bottom:1.25rem}h2[_ngcontent-%COMP%]{text-align:center;padding-left:4px;padding-right:4px;height:100px}@media (max-height: 599px){.title-margin[_ngcontent-%COMP%]{margin-top:.25rem;margin-bottom:.25rem}.upload-img[_ngcontent-%COMP%]{width:330px!important;padding:1rem}.scan-img[_ngcontent-%COMP%]{width:285px!important;margin-bottom:.25rem;padding:1rem}}@media (min-height: 600px) and (max-height: 959px){.title-margin[_ngcontent-%COMP%]{margin-top:.5rem;margin-bottom:.5rem}.upload-img[_ngcontent-%COMP%]{width:370px!important;padding:1rem}.scan-img[_ngcontent-%COMP%]{width:325px!important;padding:1rem}}@media (max-width: 599px){.upload-file-section[_ngcontent-%COMP%]{width:95%!important;min-height:300px}.upload-file-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;text-align:center;padding:8px;height:65px!important}.scan-file-section[_ngcontent-%COMP%]{width:95%!important;min-height:700px}.scan-file-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;text-align:center;padding:8px;height:65px!important}}@media (min-width: 600px) and (max-width: 959px){.upload-file-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .scan-file-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;text-align:center;padding:8px}}"],data:{animation:O.L}})}return o})();var E=l(3403);function Xe(o,r){1&o&&e._UZ(0,"mat-progress-bar",10)}function qe(o,r){1&o&&e._UZ(0,"kyc-instructions")}function ze(o,r){1&o&&e._UZ(0,"kyc-document")}function Ge(o,r){1&o&&e._UZ(0,"kyc-document-review")}function Be(o,r){1&o&&e._UZ(0,"kyc-liveness")}function $e(o,r){1&o&&e._UZ(0,"kyc-liveness-ios")}function et(o,r){1&o&&e._UZ(0,"kyc-end")}function tt(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"img",4),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.backToStepOne())}),e.qZA()(),e.TgZ(4,"div",5)(5,"div",6),e._UZ(6,"languages"),e.qZA()()(),e.YNc(7,Xe,1,0,"mat-progress-bar",7),e.ynx(8,8),e.YNc(9,qe,1,0,"kyc-instructions",9),e.YNc(10,ze,1,0,"kyc-document",9),e.YNc(11,Ge,1,0,"kyc-document-review",9),e.YNc(12,Be,1,0,"kyc-liveness",9),e.YNc(13,$e,1,0,"kyc-liveness-ios",9),e.YNc(14,et,1,0,"kyc-end",9),e.BQk(),e._UZ(15,"app-demo-footer"),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("src",t.project.branding.logo,e.LSH),e.xp6(4),e.Q6J("ngIf",t.kycData&&t.kycData.loading),e.xp6(2),e.Q6J("ngIf",1===t.navigation.currentStep),e.xp6(1),e.Q6J("ngIf","document"===t.navigation.currentStep),e.xp6(1),e.Q6J("ngIf","documentReview"===t.navigation.currentStep),e.xp6(1),e.Q6J("ngIf","liveness"===t.navigation.currentStep&&"IOS"!==t.demoData.OS),e.xp6(1),e.Q6J("ngIf","liveness"===t.navigation.currentStep&&"IOS"===t.demoData.OS),e.xp6(1),e.Q6J("ngIf","end"===t.navigation.currentStep)}}const it=[{path:"",component:(()=>{class o{constructor(t,i,n,a,c){this._router=t,this._KYCService=i,this._splashScreenService=n,this.activatedRoute=a,this._demoService=c,this.alert={type:"success",message:""},this.showAlert=!1,this._splashScreenService.show(),localStorage.removeItem("accessToken"),this.demoData=this._demoService.getDemoData()}ngOnInit(){this.activatedRoute.queryParams.subscribe(t=>{const i=t.token;i&&(localStorage.setItem("accessToken",i),this._requestAppRegistration())})}_requestAppRegistration(){this._KYCService.getAppRegistration({populates:["project","projectFlow","emailValidation","phoneValidation","biometricValidation","person"]}).subscribe({next:t=>{this.appRegistration=t.data,this.project=new s.XR(this.appRegistration.project),this.projectFlow=new s.nd(this.appRegistration.projectFlow)},error:t=>{this.errorContent=t.error,this._splashScreenService.hide()},complete:()=>{this._splashScreenService.hide(),this.navigation=this._KYCService.initNavigation(),this.requirementsLoaded=!0}})}backToStepOne(){}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(E.F0),e.Y36(T.H),e.Y36(k.j),e.Y36(E.gz),e.Y36(D.e))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["auth-forgot-password"]],standalone:!0,features:[e.jDz],decls:1,vars:1,consts:[["class","w-full",4,"ngIf"],[1,"w-full"],["fxLayout","row","fxLayoutAlign","end center",1,"w-full","demo-header"],["fxFlex",""],["alt","",1,"demo-header-logo","cursor-pointer",3,"src","click"],["fxFlex","","fxLayout","row","fxLayoutAlign","end center",1,"demo-header-actions","cursor-pointer"],["fxLayout","row","fxLayoutAlign","center center",1,"demo-header-action","cursor-pointer"],["mode","query","class","w-full",4,"ngIf"],[1,"demo-content"],[4,"ngIf"],["mode","query",1,"w-full"]],template:function(i,n){1&i&&e.YNc(0,tt,16,8,"div",0),2&i&&e.Q6J("ngIf",n.requirementsLoaded)},dependencies:[g.O5,R.u5,R.UX,K.lN,U.c,m.ot,S.Cq,y.v,L.o9,u.xw,u.Wh,u.yH,C.w,ie,We,fe,De,_e],styles:[".demo-header{background-color:#fff;width:100%;height:64px;color:#fff!important;border:1px solid rgba(128,128,128,.0784313725)}.demo-header-logo{width:52px;padding-left:16px;height:auto}.demo-header-action{padding-right:25px}.demo-header-partner-icon{width:40px;padding-right:10px}.demo-content{width:100%;height:auto}.step-one-circle{background:#0036e7;z-index:2;color:#fff;width:45px;height:45px;padding-top:11px;text-align:center;border-radius:50%;margin-right:25px}.disabled-background{background:rgba(0,54,231,.2509803922)!important}.font-bold{font-weight:800}.box-shadow-3px{box-shadow:3px 3px 3px 3px #0000000d}.grey-background{background-color:#80808021}.m-2{margin:2px}.m-4{margin:4px}.m-8{margin:8px}.mt-4{margin-top:4px}.mt-8{margin-top:8px}.cursor-pointer{cursor:pointer!important;font-weight:800}.w-50p{width:50%}.text-center{text-align:center}.margin-left-16{margin-left:25px}h1{font-size:35px;padding-top:32px;font-weight:700;color:#0036e7}h2{font-size:30px;padding-top:16px;font-weight:700;color:#0036e7}\n"],encapsulation:2,data:{animation:O.L}})}return o})()}]},8533:(Q,F,l)=>{l.d(F,{XR:()=>R,nd:()=>m});class R{constructor(s={}){if(this._id=s._id||"new",this.client=s.client,this.type=s.type,this.name=s.name,this.identifier=s.identifier,this.contactEmail=s.contactEmail,this.privacyUrl=s.privacyUrl,this.termsAndConditionsUrl=s.termsAndConditionsUrl,this.status=s.status,this.dataProtection=s.dataProtection||{name:""},this.branding=s.branding||{bgColor:"#01236D",borderColor:"#B2BDD3",txtColor:"#8091B6",titleColor:"#FFFFFF",logo:"",rightImage:"https://cdn.verifik.co/assets/auth/authb.svg",rightImagePosition:"end end",rightBackgroundColor:"white"},this.projectFlows=s.projectFlows,this.allowedCountries=s.allowedCountries||[],this.emailEnabled=!1,this.phoneEnabled=!1,this.emailAuthyEnabled=!1,this.phoneAuthyEnabled=!1,this.faceLivenessEnabled=!1,this.faceLivenessAuthyEnabled=!1,this.usesWhiteList=!1,this.whiteListLength=0,this.currentStep=s.currentStep,this.lastStep=s.lastStep,Array.isArray(s.projectFlows)&&s.projectFlows.length)for(let C=0;C<this.projectFlows.length;C++){const v=this.projectFlows[C];if(!["paused","draft"].includes(v.status)){if("active"===v.status&&v.type===this.type){this.currentProjectFlow=new m(v);break}v.type===this.type&&(this.currentProjectFlow=new m(v))}}this.currentProjectFlow?.faceLivenessAuthy&&(this.faceLivenessAuthyEnabled=!0)}}class m{constructor(s={}){this._id=s._id,this.client=s.client,this.project=s.project,this.userFeatures=s.userFeatures,this.type=s.type,this.status=s.status,this.version=s.version,this.redirectUrl=s.redirectUrl,this.webhookUrl=s.webhookUrl,this.identityUrl=s.identityUrl,this.allowedCountries=s.allowedCountries||[],this.faceLivenessAuthy=s.faceLivenessAuthy,this.webAuthN=s.webAuthN,this.documentValidation=s.documentValidation,this.appQRCode=s.appQRCode,this.loginSettings=s.loginSettings,this.onboardingSettings=s.onboardingSettings||{basicInformation:{fullName:!1,age:!1,gender:!1,address:!1,postalCode:!1}},this.onboardingSettings&&!this.onboardingSettings.basicInformation&&(this.onboardingSettings.basicInformation={fullName:!1,age:!1,gender:!1,address:!1,postalCode:!1}),this.onboardingSettings&&!this.onboardingSettings.signUpForm&&(this.onboardingSettings.signUpForm={fullName:!1,email:!1,emailGateway:"none",phone:!1,phoneGateway:"none",legalDocument:!1,legalDocumentValidation:"none",showTermsAndConditions:!1,showPrivacyNotice:!1})}}}}]);